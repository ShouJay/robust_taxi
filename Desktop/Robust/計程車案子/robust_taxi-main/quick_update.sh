#!/bin/bash

# =============================================================================
# Docker å¿«é€Ÿæ›´æ–°è…³æœ¬
# ç°¡åŒ–ç‰ˆæœ¬ï¼Œç”¨æ–¼å¿«é€Ÿé‡æ–°éƒ¨ç½²ç¨‹å¼ç¢¼
# =============================================================================

echo "ğŸš€ Docker å¿«é€Ÿæ›´æ–°ä¸­..."

# é€²å…¥ docker ç›®éŒ„
cd docker

# åœæ­¢ä¸¦é‡æ–°æ§‹å»º
echo "ğŸ“¦ é‡æ–°æ§‹å»ºå®¹å™¨..."
docker-compose down
docker-compose build --no-cache
docker-compose up -d

# ç­‰å¾…æœå‹™å•Ÿå‹•
echo "â³ ç­‰å¾…æœå‹™å•Ÿå‹•..."
sleep 10

# æª¢æŸ¥ç‹€æ…‹
echo "âœ… æª¢æŸ¥æœå‹™ç‹€æ…‹..."
if docker ps | grep -q "smart_taxi_service"; then
    echo "ğŸ‰ æ›´æ–°å®Œæˆï¼æœå‹™é‹è¡Œåœ¨ http://localhost:8080"
else
    echo "âŒ æœå‹™å•Ÿå‹•å¤±æ•—ï¼Œè«‹æª¢æŸ¥æ—¥èªŒ: docker logs smart_taxi_service"
fi
